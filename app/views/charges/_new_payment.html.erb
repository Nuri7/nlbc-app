<%= form_tag charges_path do %>
<input type="hidden" name="trainer_id" value="<%= trainer.id %>">
<input type="hidden" name="trainer_email" value="<%= trainer.email %>">
<input type="hidden" name="selected_challenges" value="<%= @selected_challenges %>">
  <article>
    <% if flash[:error].present? %>
      <div id="error_explanation">
        <p><%= flash[:error] %></p>
      </div>
    <% end %>
  </article>

  <script src="https://checkout.stripe.com/v2/checkout.js" class="stripe-button"
          data-key="<%= Rails.configuration.stripe[:publishable_key] %>"
          data-description="Selected challenges: <%= params[:challenges].present? ? params[:challenges].count : 0 %>"
          data-amount="<%= (params[:challenges].present? ? Challenge.where(id: params[:challenges]).map{|challenge| challenge.price}.compact.inject(:+) : 0) * 100 %>"
          data-locale="auto">
    Stripe.setPublishableKey("<%= Rails.configuration.stripe[:publishable_key] %>");
  </script>
<% end %>
<script type="text/javascript">
    $(document).ready(function(){
            $("button.stripe-button-el").removeAttr('style').css({
              "border-radius": "0px",
              "padding": "3px 4px",
              "box-sizing": "border-box",
              "text-decoration": "none",
              "overflow": "hidden",
              "color": "#fff",
              "font-weight": "400",
              "font-size": "15px",
              "border": "none",
              "transition": "color 0.7s cubic-bezier(0.215, 0.61, 0.355, 1),background 0.7s cubic-bezier(0.215, 0.61, 0.355, 1),border 0.7s cubic-bezier(0.215, 0.61, 0.355, 1)",
              "background":"#7302A1",
              "cursor": "pointer" }).html("Book me");
        });
</script>
